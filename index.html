<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>EcoTrack UNAL - Demo (Index)</title>
  <meta name="description" content="Herramienta digital de seguimiento ISO 14001 para la Universidad Nacional - Sede Bogot√°. Mockup funcional en un solo archivo.">
  <style>
    :root{ --bg:#f7f7f7; --surface:#ffffff; --surface-2:#fafafa; --text:#222; --muted:#555; --line:#d8d8d8; --brand:#2f6b3c; --brand-2:#3b7c48; --ok:#2e7d32; --warn:#c77700; --bad:#c62828; --radius:8px; --font: "Segoe UI", Arial, Helvetica, sans-serif; }
    *{box-sizing:border-box}
    body{margin:0;font-family:var(--font);background:var(--bg);color:var(--text);}
    /* Simple SPA layout */
    .app{min-height:100vh;display:flex;}
    aside{width:280px;background:#f0f3f0;border-right:1px solid var(--line);padding:20px}
    main{flex:1}
    .brand{display:flex;gap:12px;align-items:center}
    .brand .logo{width:44px;height:44px;background:var(--brand);border-radius:6px;color:#fff;display:grid;place-items:center;font-weight:700}
    nav a{display:flex;gap:10px;align-items:center;padding:10px;border-radius:6px;color:var(--text);text-decoration:none}
    nav a.active{background:#e0e7e0;font-weight:600}
    header{display:flex;align-items:center;justify-content:space-between;padding:14px 20px;background:var(--surface);border-bottom:1px solid var(--line)}
    .search{display:flex;gap:8px;align-items:center;background:var(--surface-2);border:1px solid var(--line);padding:8px 12px;border-radius:6px;width:60%}
    .btn{background:var(--brand);color:#fff;border:none;padding:10px 14px;border-radius:6px;cursor:pointer;font-weight:600}
    .btn.secondary{background:#ececec;color:#222;border:1px solid var(--line)}
    .panel{padding:16px;background:var(--surface);border:1px solid var(--line);border-radius:8px;margin:16px}
    .grid{display:grid;gap:16px}
    .kpis{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-top:10px}
    .kpi{padding:12px;border-radius:6px;border:1px solid var(--line);background:var(--surface-2)}
    table{width:100%;border-collapse:collapse}
    th,td{padding:12px;border-bottom:1px solid var(--line);text-align:left}

    /* Login screen */
    .loginWrap{min-height:100vh;display:grid;place-items:center}
    .loginCard{width:420px;background:var(--surface);padding:24px;border-radius:12px;border:1px solid var(--line);box-shadow:0 6px 20px rgba(0,0,0,0.04)}
    .loginCard h2{margin:0 0 12px}
    .field{margin-bottom:12px}
    input[type=text], input[type=password], select{width:100%;padding:10px;border:1px solid var(--line);border-radius:6px}
    .usersList{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .userChip{padding:6px 10px;border-radius:999px;background:#eef6ee;border:1px solid var(--line);cursor:pointer}
    .small{font-size:13px;color:var(--muted)}

    /* Responsive */
    @media (max-width:900px){aside{display:none}.app{flex-direction:column}header .search{width:100%}}
  </style>
</head>
<body>

<!-- Simple client-side SPA in one file -->
<div id="root"></div>

<script>
// --- Mock users (for demo) ---
const USERS = [
  {id:'oga_admin', name:'OGA Admin', role:'oga', pwd:'admin123'},
  {id:'predio_resp', name:'Responsable Predio', role:'resp', pwd:'predio123'},
  {id:'coordinador', name:'Coordinador SGAU', role:'coord', pwd:'coord123'},
  {id:'invitado', name:'Invitado', role:'guest', pwd:'guest'},
];

// --- Simple router and state ---
const state = { user:null, page:'login', data: null };

function mount(el){
  const root = document.getElementById('root');
  root.innerHTML = '';
  if(state.page==='login') root.appendChild(renderLogin());
  else root.appendChild(renderApp());
}

// --- Helper to create elements easily ---
function el(tag, attrs={}, children=[]){
  const d = document.createElement(tag);
  for(const k in attrs){ if(k.startsWith('on')) d.addEventListener(k.slice(2), attrs[k]); else if(k==='html') d.innerHTML = attrs[k]; else d.setAttribute(k, attrs[k]); }
  if(typeof children==='string') d.textContent = children; else (children||[]).forEach(c=>d.appendChild(typeof c==='string'?document.createTextNode(c):c));
  return d;
}

// --- Login view ---
function renderLogin(){
  const wrap = el('div',{class:'loginWrap'});
  const card = el('div',{class:'loginCard'});
  card.appendChild(el('h2',{},'EcoTrack UNAL ‚Äî Acceso'));
  card.appendChild(el('p',{class:'small'},'Herramienta de seguimiento ISO 14001 ‚Äì Demo local. Seleccione usuario o ingrese credenciales.'));

  const userField = el('div',{class:'field'}, [el('label',{},'Usuario (ID)'), el('input',{type:'text', id:'loginId', placeholder:'ej: oga_admin'})]);
  const pwdField = el('div',{class:'field'}, [el('label',{},'Contrase√±a'), el('input',{type:'password', id:'loginPwd', placeholder:'contrase√±a demo'})]);

  const btn = el('button',{class:'btn', onClick:handleLogin}, 'Iniciar sesi√≥n');
  const demoInfo = el('div',{class:'small'}, 'Usuarios demo:');
  const chips = el('div',{class:'usersList'});
  USERS.forEach(u=>{
    const c = el('div',{class:'userChip', onClick:()=>{ document.getElementById('loginId').value = u.id; document.getElementById('loginPwd').value = u.pwd; }}, u.name+' ('+u.id+')');
    chips.appendChild(c);
  });

  card.appendChild(userField); card.appendChild(pwdField); card.appendChild(btn); card.appendChild(demoInfo); card.appendChild(chips);
  wrap.appendChild(card);
  return wrap;
}

function handleLogin(){
  const id = document.getElementById('loginId').value.trim();
  const pwd = document.getElementById('loginPwd').value;
  const u = USERS.find(x=>x.id===id && x.pwd===pwd);
  if(!u){ alert('Credenciales incorrectas (usar usuarios demo).'); return; }
  state.user = u; state.page='app'; mount();
}

// --- Main app layout ---
function renderApp(){
  const container = el('div',{class:'app'});
  container.appendChild(renderSidebar());
  container.appendChild(renderMain());
  return container;
}

function navTo(page){ state.page = page; mount(); }

function renderSidebar(){
  const a = el('aside');
  const brand = el('div',{class:'brand'});
  brand.appendChild(el('div',{class:'logo'},'UN'));
  brand.appendChild(el('div',{}, [el('div',{html:'<strong>EcoTrack UNAL</strong>'}), el('small',{class:'small', html:'ISO 14001 - Sede Bogot√°'})]));
  a.appendChild(brand);

  const nav = el('nav');
  const links = [ ['home','Inicio'], ['predios','Predios'], ['reportes','Reportes'], ['alertas','Alertas'], ['config','Configuraci√≥n'] ];
  links.forEach(l=>{
    const [id,label] = l;
    const link = el('a',{href:'#', onClick:(e)=>{e.preventDefault(); navTo(id);}, class: state.page===id? 'active':''}, [label]);
    nav.appendChild(link);
  });
  a.appendChild(nav);
  a.appendChild(el('hr'));
  a.appendChild(el('div',{class:'small'}, 'Usuario activo: ' + (state.user? state.user.name : '‚Äî')));
  a.appendChild(el('div',{style:'margin-top:8px'}, el('button',{class:'btn secondary', onClick:()=>{ state.user=null; state.page='login'; mount(); }}, 'Cerrar sesi√≥n')));
  return a;
}

function renderMain(){
  const main = el('div');
  main.appendChild(renderHeader());
  const content = el('div');
  // content area (switch pages)
  if(state.page==='home') content.appendChild(renderHome());
  if(state.page==='predios') content.appendChild(renderPredios());
  if(state.page==='reportes') content.appendChild(renderReportes());
  if(state.page==='alertas') content.appendChild(renderAlertas());
  if(state.page==='config') content.appendChild(renderConfig());
  main.appendChild(content);
  return main;
}

function renderHeader(){
  const h = el('header');
  const search = el('div',{class:'search'}, [el('span',{},'üîé'), el('input',{type:'text', placeholder:'Buscar predio, alerta o requisito‚Ä¶', id:'searchBox'})]);
  h.appendChild(search);
  const actions = el('div');
  actions.appendChild(el('button',{class:'btn secondary', onClick:()=>alert('Subir evidencia (simulado).')}, 'Subir evidencia'));
  actions.appendChild(el('button',{class:'btn', onClick:()=>alert('Generar reporte (simulado).')}, 'Generar reporte'));
  h.appendChild(actions);
  return h;
}

// --- Demo data reused from mockup ---
const predios = [
  { nombre: "Ciudad Universitaria", responsable: "D. Moreno", cumplimiento: 86 },
  { nombre: "Centro Agropecuario Marengo", responsable: "M. Rojas", cumplimiento: 62 },
  { nombre: "Hospital Universitario", responsable: "S. P√©rez", cumplimiento: 45 },
  { nombre: "Campus Santa Rosa", responsable: "L. Garc√≠a", cumplimiento: 78 },
  { nombre: "Complejo cultural casa Gait√°n", responsable: "P. √Ålvarez", cumplimiento: 91 },
  { nombre: "Claustro San Agust√≠n", responsable: "N. G√≥mez", cumplimiento: 73 },
  { nombre: "Observatorio Astron√≥mico Nacional", responsable: "C. Torres", cumplimiento: 67 },
  { nombre: "Edificio Las Nieves", responsable: "V. Pardo", cumplimiento: 81 }
];
const alertas = [
  { tipo: "Documental", texto: "Matriz de aspectos e impactos ambientales no actualizada (cl√°usula 6.1.2) en Ciudad Universitaria.", gravedad: "alta" },
  { tipo: "Legal", texto: "Matriz de requisitos legales y otros no actualizada y sin evaluaci√≥n de cumplimiento en Edificio Las Nieves.", gravedad: "alta" },
  { tipo: "Operativa", texto: "Faltan controles operacionales para segregaci√≥n y almacenamiento de residuos peligrosos en Hospital Universitario.", gravedad: "alta" },
  { tipo: "Emergencias", texto: "Plan de preparaci√≥n y respuesta ante emergencias sin simulacro anual registrado en Campus Santa Rosa.", gravedad: "media" }
];

function renderHome(){
  const wrap = el('div');
  const panel = el('div',{class:'panel'});
  panel.appendChild(el('h3',{},'Resumen general'));
  panel.appendChild(el('p',{class:'small'}, 'Seguimiento de la implementaci√≥n ISO 14001 - Sede Bogot√°.'));
  // KPIs
  const kpiWrap = el('div',{class:'kpis'});
  kpiWrap.appendChild(el('div',{class:'kpi'}, [el('div',{class:'small'},'Predios evaluados'), el('strong',{id:'kp1'}, predios.length)]));
  kpiWrap.appendChild(el('div',{class:'kpi'}, [el('div',{class:'small'},'Alertas abiertas'), el('strong',{id:'kp2'}, alertas.length)]));
  kpiWrap.appendChild(el('div',{class:'kpi'}, [el('div',{class:'small'},'Cumplimiento promedio'), el('strong',{id:'kp3'}, Math.round(predios.reduce((a,p)=>a+p.cumplimiento,0)/predios.length)+'%')]));
  kpiWrap.appendChild(el('div',{class:'kpi'}, [el('div',{class:'small'},'√öltima actualizaci√≥n'), el('strong',{id:'kp4'}, new Date().toLocaleDateString())]));
  panel.appendChild(kpiWrap);
  wrap.appendChild(panel);
  wrap.appendChild(renderPrediosMini());
  return wrap;
}

function renderPrediosMini(){
  const p = el('div',{class:'panel'});
  p.appendChild(el('h3',{},'Predios'));
  const table = el('table');
  table.innerHTML = `<thead><tr><th>Predio</th><th>Responsable</th><th>Cumplimiento</th></tr></thead>`;
  const tb = el('tbody');
  predios.forEach(pr=> tb.appendChild(el('tr',{}, [ el('td',{},pr.nombre), el('td',{},pr.responsable), el('td',{}, pr.cumplimiento+'%')] )));
  table.appendChild(tb);
  p.appendChild(table);
  return p;
}

function renderPredios(){
  const p = el('div');
  p.appendChild(el('div',{class:'panel'}, [el('h3',{},'Predios ‚Äî Detalle'), el('p',{class:'small'}, 'Porcentaje de cumplimiento y acciones sugeridas.')]))
  const table = el('table');
  table.innerHTML = `<thead><tr><th>Predio</th><th>Responsable</th><th>Cumplimiento</th><th>Acciones</th></tr></thead>`;
  const tb = el('tbody');
  predios.forEach(pr=>{
    const tr = el('tr');
    tr.appendChild(el('td',{},pr.nombre));
    tr.appendChild(el('td',{},pr.responsable));
    tr.appendChild(el('td',{},pr.cumplimiento+'%'));
    const btn = el('button',{class:'btn secondary', onClick:()=>alert('Ver detalle: '+pr.nombre)}, 'Ver detalle');
    tr.appendChild(el('td',{}, btn));
    tb.appendChild(tr);
  });
  table.appendChild(tb);
  p.appendChild(table);
  return p;
}

function renderReportes(){
  const r = el('div');
  r.appendChild(el('div',{class:'panel'}, [el('h3',{},'Reportes autom√°ticos'), el('p',{class:'small'}, 'Generaci√≥n de informes para OGA y Consejo de Sede (simulada).')]))
  r.appendChild(el('div',{class:'panel'}, [el('label',{class:'small'}, 'Periodo:'), el('select',{}, [ el('option',{},'√öltimo mes'), el('option',{},'√öltimo trimestre'), el('option',{},'√öltimo semestre')]) ]))
  r.appendChild(el('div',{class:'panel'}, el('button',{class:'btn', onClick:()=>alert('Descargar PDF (simulaci√≥n).')}, 'Descargar informe PDF')));
  return r;
}

function renderAlertas(){
  const a = el('div');
  a.appendChild(el('div',{class:'panel'}, [el('h3',{},'Alertas recientes'), el('p',{class:'small'}, 'Alertas generadas por falta de cumplimiento y registros.')]))
  const list = el('ul');
  alertas.forEach(al=> list.appendChild(el('li',{}, al.tipo + ' ‚Äî ' + al.texto)));
  a.appendChild(el('div',{class:'panel'}, list));
  return a;
}

function renderConfig(){
  const c = el('div');
  c.appendChild(el('div',{class:'panel'}, [el('h3',{},'Configuraci√≥n'), el('p',{class:'small'}, 'Ajustes del sistema y gesti√≥n de usuarios (demo).')]));
  c.appendChild(el('div',{class:'panel'}, [el('h4',{},'Usuarios demo'), el('div',{class:'usersList'}, USERS.map(u=> el('div',{class:'userChip'}, u.name + ' ('+u.id+')')))]));
  return c;
}

// Initialize
mount();
</script>

</body>
</html>
